Documentation Verification Changelog
=====================================

Last audited: 2026-02-04

All README.md files have been systematically verified against the actual
source code. This file tracks what was checked and what was fixed.

README/DESIGN_DOC Split + MY_ASM/MY_LD Correction (2026-02-04):
  - Split top-level README.md into focused README (building, usage, status)
    and DESIGN_DOC.md (architecture, pipeline, design decisions)
  - Fixed incorrect MY_ASM/MY_LD environment variable documentation across
    all READMEs. The actual mechanism is compile-time Cargo features
    (gcc_assembler, gcc_linker, gcc_m16), not runtime env vars. The builtin
    assembler and linker are the default; no env vars needed.
  - Updated: README.md, DESIGN_DOC.md (new), src/backend/README.md,
    src/driver/README.md, src/backend/x86/README.md,
    src/backend/x86/assembler/README.md, src/backend/arm/README.md,
    src/backend/arm/assembler/README.md, src/backend/arm/linker/README.md,
    src/backend/riscv/README.md, src/backend/riscv/linker/README.md

Builtin Assembler/Linker Documentation Update (2026-02-04):
  README.md (top-level):
  - Fixed false claim "Assembly and linking currently delegate to GNU toolchain"
  - Removed "External toolchain required" from Known Limitations
  - Updated pipeline diagram to show builtin assembler and linker stages
  - Added "Assembler and Linker Selection" section with MY_ASM/MY_LD docs
  - Updated source tree to include assembler/ and linker/ per architecture
  - Updated data flow diagram to show builtin assembler/linker path
  - Added "Builtin assembler and linker" to Key Design Decisions
  - Fixed "No compiler-specific dependencies" to "Zero external dependencies"
  - Removed reference to ideas/native_elf_writer.txt (now completed)

  src/backend/README.md:
  - Fixed opening paragraph: "delegates to external GCC" -> "assembles and links
    into ELF executables" with builtin assembler/linker description
  - Updated pipeline diagram to show builtin assembler and linker stages
  - Updated step 5 description to mention builtin or external toolchain
  - Added assembler/linker subdirectories to directory layout
  - Replaced "External Toolchain Integration" section with comprehensive
    "Builtin Assembler" and "Builtin Linker" design sections
  - Added "Assembler and Linker Selection" section

  src/backend/x86/README.md:
  - Added builtin assembler/linker mention to opening paragraph

  src/backend/arm/README.md:
  - Fixed "assembled by the system assembler" to mention builtin assembler/linker

  src/backend/i686/README.md:
  - Added builtin assembler/linker mention to overview

  New design documents:
  - src/backend/x86/assembler/README.md (new)
  - src/backend/x86/linker/README.md (new)
  - src/backend/arm/assembler/README.md (new)
  - src/backend/arm/linker/README.md (new)
  - src/backend/riscv/assembler/README.md (new)
  - src/backend/riscv/linker/README.md (new)
  - src/backend/i686/assembler/README.md (new)
  - src/backend/i686/linker/README.md (new)

  Deleted completed ideas:
  - ideas/native_elf_writer.txt (all 4 architectures now have builtin asm+ld)

Accuracy Audit (2026-02-03):
  src/frontend/README.md:
  - Fixed `$` in identifiers claim (always permitted, not gated by gnu_extensions)
  - Fixed Token described as tuple -> struct with named fields
  - Fixed Parser::new() signature (takes only Vec<Token>)
  - Fixed "five impl Parser blocks" -> six (includes parser.rs core block)
  - Fixed TranslationUnit described as Vec -> struct { decls: Vec<ExternalDecl> }

  src/ir/README.md:
  - Added missing IrType variants: U8, U16, U32, U64, U128, Void
  - Fixed instruction count from "approximately 30" to 38
  - Removed false claim that IrBinOp has eval_f64 method
  - Fixed CfgAnalysis "loop information" claim (contains block count, not loops)
  - Fixed Pclmulqdq -> Pclmulqdq128 intrinsic name

  src/passes/README.md:
  - Fixed div_by_const annotation from "(64-bit)" to "(disabled on 32-bit)"
  - Rewrote dependency graph to match actual should_run! edges
  - Fixed IPCP description (uses dirty tracking, not should_run! system)

  src/backend/README.md:
  - Fixed method count to ~185 methods, ~50 defaults
  - Removed nonexistent emit_call_indirect method
  - Fixed "6-phase call sequence" to 8-phase
  - Fixed "approximately 17 codegen files" to 18-19
  - Fixed "Backends provide free functions" to "traits.rs provides free functions"
  - Added note about x86 peephole being a subdirectory

  src/common/README.md:
  - Fixed LP64 int/long claim ("both 64 bits" is wrong; int is 32, long is 64)
  - Fixed decode_pua_byte signature (takes &[u8]+pos, not a char)
  - Fixed eval_const_binop_int described as "public" (it is module-private)

  src/driver/README.md:
  - Fixed --print-search-dirs to -print-search-dirs (single dash, matches GCC)
  - Expanded target detection to document aarch64 and i386 triggers

  README.md (top-level):
  - Added IrType U8-U128 and Void to dual type system description
  - Added Design Philosophy section
  - Updated ArchCodegen method count to ~185

  src/ir/instruction.rs:
  - Fixed doc comment instruction count from "~30" to "38"

Full Overhaul (2026-02-02):
- README.md: Complete rewrite as proper project README
  - Fixed GCC version to "14.2.0"/"14" (matches actual -dumpversion output)
  - Added -Os/-Oz to optimization levels
  - Accurate long double description (x87 + ARM/RISC-V soft-float)
  - Added _Atomic, optimization level uniformity notes
  - Listed ALL backend shared files
  - Added dead_statics and resolve_asm to passes listing
  - Added peephole optimization as key design decision
  - Added phi elimination step to pipeline diagram

- src/backend/x86/README.md: Complete rewrite with actual codegen file table
- src/backend/arm/README.md: Complete rewrite with codegen file table
- src/backend/riscv/README.md: Updated file table
- src/backend/i686/README.md: Updated file table
- src/ir/lowering/README.md: Added missing expr_sizeof.rs
- src/frontend/README.md: Improved module descriptions
- src/frontend/lexer/README.md: Expanded design notes

Verified Correct (no changes needed, 2026-02-02):
- src/backend/README.md: All shared files match disk
- src/passes/README.md: All submodule files match disk; pipeline order accurate
- src/common/README.md: All modules match disk
- src/ir/README.md: All files + directories match disk
- src/frontend/preprocessor/README.md: All files match disk
- src/frontend/parser/README.md: All files match disk
- src/frontend/sema/README.md: All files match disk
- src/ir/mem2reg/README.md: All files match disk
- src/backend/x86/codegen/peephole/README.md: Accurate pass pipeline
- src/driver/README.md: Accurate pipeline and module descriptions
